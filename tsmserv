        msg: "TSM Config File: {{ 'OK' if tsm_config.stat.exists else 'NOTOK' }}"

    - name: Extract TSM filesystems from fstab
      shell: grep stg /etc/fstab | awk '{print $2}'
      register: tsm_filesystems
      ignore_errors: yes

    - name: Check if TSM filesystems are mounted
      shell: mount | grep -w {{ item }}
      with_items: "{{ tsm_filesystems.stdout_lines }}"
      register: mount_check
      ignore_errors: yes

    - name: Add TSM filesystems mount status to test results
      set_fact:
        test_results: "{{ test_results }}\nFilesystem {{ item.item }}: {{ 'OK' if item.stdout else 'NOTOK' }}"
      with_items: "{{ mount_check.results }}"

    - name: Display TSM filesystems mount status
      debug:
        msg: "Filesystem {{ item.item }}: {{ 'OK' if item.stdout else 'NOTOK' }}"
      with_items: "{{ mount_check.results }}"

    - name: Check if LACP is activated
      shell: nmcli con show | grep bond
      register: lacp_check
      ignore_errors: yes

    - name: Add LACP status to test results
      set_fact:
        test_results: "{{ test_results }}\nLACP: {{ 'OK' if lacp_check.stdout else 'NOTOK' }}"

    - name: Display LACP status
      debug:
        msg: "LACP: {{ 'OK' if lacp_check.stdout else 'NOTOK' }}"

    - name: Check number of volume groups
      shell: vgs --noheadings | wc -l
      register: vg_count
      ignore_errors: yes

    - name: Add VG count status to test results
      set_fact:
        test_results: "{{ test_results }}\nVG Count: {{ 'OK' if vg_count.stdout|int > 10 else 'NOTOK' }}"

    - name: Display VG count status
      debug:
        msg: "VG Count: {{ 'OK' if vg_count.stdout|int > 10 else 'NOTOK' }}"

    - name: Write test results to a file
      copy:
        content: "{{ test_results }}"
        dest: /tmp/tsm_validation_results.txt
      ignore_errors: yes
